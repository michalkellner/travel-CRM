<!DOCTYPE html>
<html lang="en">
    <head>
        {{> main}}
        <title>Customer Dashboard</title>
    </head>
    <body>
        <div class="container">
            <h2 class="page-title">Customer Dashboard: {{customer.customer_name}}</h2>
            
            <!-- Customer Details -->
            <div class="customer-details">
                <h3>Customer Details</h3>
                <p><strong>Name:</strong> {{customer.customer_name}}</p>
                <p><strong>Email:</strong> {{customer.email}}</p>
                <p><strong>Phone:</strong> {{customer.phone_number}}</p>
            </div>
            <hr style="border: none; height: 4px; background-color: #333; margin: 20px 0;">
            <!-- Bookings -->
            {{#each bookings}}
            <div class = "booking">
                <h3> Booking for {{this.retreat_name}}</h3>
                
                <p><strong>Retreat Date:</strong> {{formatDate this.retreat_date}}</p>
                <p><strong>Number of Guests:</strong> {{this.num_guests}}</p>
                <p><strong>Total Price:</strong> ${{this.total_price}}</p>
                <p><strong>Booking Status:</strong> {{this.status}}</p>
                
                <!-- Edit Booking Button -->
                <div class= "edit-booking">
                    <a href="/edit-booking/{{this.booking_id}}" class="btn btn-secondary">Edit Booking</a>
                </div>

                <!-- Book Rooms -->
                <div class ="booked-rooms">
                    <h4>Booked Rooms</h4>
                    <table class="rooms-table">
                        <thead>
                            <tr>
                                <th>Room Name</th>
                                <th>Price</th>
                                <th>Capacity</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each this.rooms}}
                            <tr>
                                <td>{{this.room_name}}</td>
                                <td>${{this.price}}</td>
                                <td>{{this.capacity}} guests</td>
                            </tr>
                            {{/each}}
                        </tbody>
                    </table>
                </div>

                <!-- Booked Meals -->
                <div class="booked-meals">
                    <h4>Booked Meals</h4>
                    <table class="meals-table">
                        <thead>
                            <tr>
                                <th>Meal Name</th>
                                <th>Count</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each this.meals}}
                            <tr>
                                <td>{{this.meal_name}}</td>
                                <td>{{this.meal_count}}</td>
                            </tr>
                            {{/each}}
                        </tbody>
                    </table>
                </div>

                <!-- Special Requests -->
                <div class="special-requests">
                    <h4>Special Requests</h4>
                    <p>{{#if this.special_requests}}{{this.special_requests}}{{else}}No special requests provided.{{/if}}</p>
                </div>
            </div>
        <hr style="border: none; height: 4px; background-color: #333; margin: 20px 0;">
        {{/each}}
    </div>
    {{> footer}}
</body>
</html>
