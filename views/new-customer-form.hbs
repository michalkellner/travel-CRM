<!DOCTYPE html>
<html lang="en">
	<head>
		{{> main}}
		<title>New Customer and Booking</title>
		<script>
			document.addEventListener('DOMContentLoaded', () => {
				const retreats = {{{json retreats}}}; // Pass the JSON encoded retreat array

				const retreatSelect = document.getElementById('retreat_id');
				const startDateField = document.getElementById('start_date');
				const mealSelect = document.getElementById('meal_choices');

				function updateRetreatDetails() {
					const selectedId = retreatSelect.value;
					const retreat = retreats.find(r => r.reteat_id == selectedId);

					if (retreat) {
						// Update start date
						startDateField.value = retreat.start_date;

						// Update meal options
						mealSelect.innerHTML = '';
						retreat.meal_options.forEach(option => {
							const opt = document.createElement('option');
							opt.value = option;
							opt.textContent = option;
							mealSelect.appendChild(opt);
						});
					}

				}

				retreatSelect.addEventListener('change', updateRetreatDetails);
				updateRetreatDetails(); // Trigger on load
			});
		</script>
	</head>
	<body>
		
		<div class="new-customer-container">
			<div class="new-customer-title">Add a new customer:</div>
			<form class="new-customer-form" id="new-customer-form" action="/customers" method="POST">
				<div class="new-customer-label">Name</div>
				<input type="text" id="name" name="name">
				<div class="new-customer-label">Email</div>
				<input type="text" id="email" name="email">
				<div class="new-customer-label">Phone Number</div>
				<input type="text" id="phone" name="phone">
				<input type="submit" value="Submit">
			</form>
			<div id="new-customer-confirmation"> Customer added to database.</div>
		</div>
		{{> footer}}
	</body>
</html>